{% extends 'admin/base.html' %}

{% block title %}Categories{% endblock %}

{% block content %}

<!-- Tab content pane begins =============================================== -->
<div id="cats">
    <!-- Create new org category begins =============================================== -->
    <div class="well new-cat col-xs-12">
        <h4>Add a new organization category</h4>
        {% if lang =='en' %}
        {{ form.action('New category', url_for('category_new', cat_type=cat_type), class='btn btn-default btn-sm btn-primary btn-success pull-right') }}
        {% endif %}
    </div>
    <!-- /Create new org category ends =============================================== -->


    <div class="col-xs-12"><h2>Edit existing organization category<br /><br /></h2></div>

    <!-- Edit existing org category section begins =============================================== -->
    {% for cat in all %}<div class="well col-xs-12 org-cat-list">
        <ul>
            
            <!-- Edit existing org main category begins =============================================== -->
            <li class="org-cat-top-level">
                <h4>{{ cat.title }}</h4>
                {% if not cat.active %}
                    <span class="bg-warning">Inactive</span>
                {% endif %}
                {# FIXME Place icon inside button #}
                    <span class="glyphicon glyphicon-pencil"></span>{{ form.action_link('edit', url_for_admin('category_edit', id=cat.id, cat_type=cat_type)) }}
                {% if lang =='en' %}
                {# FIXME Place icon inside button #}
                    <span class="glyphicon glyphicon-tag"></span>{{ form.action('New code', url_for('code_new', category_id=cat.category_id, cat_type=cat_type), class='btn btn-default btn-sm btn-success') }}
                {% endif %}
                {% if lang =='en' %}
                    {{ form.action('Delete category', url_for('category_delete', category_id=cat.category_id, cat_type=cat_type), class='btn btn-default btn-sm btn-danger pull-right', onsubmit='return confirm("Are you sure you want to delete this category?\\n\\nThis action cannot be undone")') }}
                {% endif %}
            <!-- /Edit existing org main category ends =============================================== -->

                <ul>
                {% for code in cat.codes %}
                    <!-- Edit existing org sub category begins =============================================== -->
                    <li class="col-xs-12 pull-right">
                        <h5>{{ code.title }}</h5>
                        {% if not code.active %}
                            <span class="bg-warning">Inactive</span>
                        {% endif %}
                    {# FIXME Place icon inside button #}    
                    {# FIXME Insert button classes: btn btn-default btn-xs #}
                    <span class="glyphicon glyphicon-pencil"></span>{{ form.action_link('edit', url_for_admin('code_edit', id=code.id, cat_type=cat_type)) }}
                        {% if lang =='en' %}
                            {{ form.action('Delete code', url_for('code_delete', code_id=code.code, cat_type=cat_type), class='btn btn-default btn-xs btn-danger', onsubmit='return confirm("Are you sure you want to delete this code?\\n\\nThis action cannot be undone")') }}
                        {% endif %}
                    </li>
                {% endfor %}
                    <!-- /Edit existing org sub category ends =============================================== -->
                </ul>
            </li>
            
        </ul>
        
    </div>
    {#  {{ form.code_list(all) }} #}
    {% endfor %}
    <!-- /Edit existing org category section ends =============================================== -->
</div>
<!-- /Tab content pane ends =============================================== -->


<ul>
    {% for cat in all %}
    <li>
        {{ cat.title }}
        {% if not cat.active %}
        <span class="bg-warning">Inactive</span>
        {% endif %}
        {{ form.action_link('edit', url_for_admin('category_edit', id=cat.id, cat_type=cat_type)) }}
        {% if lang =='en' %}
        {{ form.action('New code', url_for('code_new', category_id=cat.category_id, cat_type=cat_type), class='btn-primary') }}
        {% endif %}
        {% if lang =='en' %}
        {{ form.action('Delete', url_for('category_delete', category_id=cat.category_id, cat_type=cat_type), class='btn-danger', onsubmit='return confirm("Are you sure you want to delete this category?\\n\\nThis action cannot be undone")') }}
        {% endif %}
    </li>
    <ul>
        {% for code in cat.codes %}
        <li>{{ code.title }}
            {% if not code.active %}
            <span class="bg-warning">Inactive</span>
            {% endif %}
            {{ form.action_link('edit', url_for_admin('code_edit', id=code.id, cat_type=cat_type)) }}
            {% if lang =='en' %}
            {{ form.action('Delete', url_for('code_delete', code_id=code.code, cat_type=cat_type), class='btn-danger', onsubmit='return confirm("Are you sure you want to delete this code?\\n\\nThis action cannot be undone")') }}
            {% endif %}
        </li>
        {% endfor %}

        {% for code in m_codes[cat.category_id] %}
        <li>{{ code.title }}
            {% if not code.active %}
            <span class="bg-warning">Inactive</span>
            {% endif %}
            <span class="bg-danger">Missing</span>
            {{ form.action('Create', url_for_admin('code_trans', id=code.id, cat_type=cat_type)) }}
        </li>
        {% endfor %}
    </ul>
    {% endfor %}

    {% for cat in missing_cat %}
    <li>
        {{ cat.title }}
        <span class="bg-danger">Missing</span>
        {{ form.action('Create', url_for_admin('category_trans', id=cat.id, cat_type=cat_type)) }}
    </li>
    {% endfor %}
</ul>
{#  {{ form.code_list(all) }} #}
{% endblock %}
